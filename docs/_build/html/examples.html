<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Examples &#8212; golfball 3.0.0 documentation</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css?v=67a6116b" />
    <link rel="stylesheet" type="text/css" href="_static/pydoctheme.css?v=5ff89526" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="_static/pygments_dark.css?v=5349f25f" />
    
    <script src="_static/documentation_options.js?v=acc74ff5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="For Developers" href="developers.html" />
    <link rel="prev" title="Quickstart" href="quickstart.html" /><link rel="stylesheet" href="_static/pydoctheme_dark.css" media="(prefers-color-scheme: dark)" id="pydoctheme_dark_css">
    <link rel="shortcut icon" type="image/png" href="_static/py.svg">
            <script type="text/javascript" src="_static/copybutton.js"></script>
            <script type="text/javascript" src="_static/menu.js"></script>
            <script type="text/javascript" src="_static/search-focus.js"></script>
            <script type="text/javascript" src="_static/themetoggle.js"></script> 
  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="Menu">
    <nav class="nav-content" role="navigation">
        <label for="menuToggler" class="toggler__label">
            <span></span>
        </label>
        <span class="nav-items-wrapper">
            <a href="https://www.python.org/" class="nav-logo">
                <img src="_static/py.svg" alt="Python logo">
            </a>
            <span class="version_switcher_placeholder"></span>
            <form role="search" class="search" action="search.html" method="get">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                    <path fill-rule="nonzero" fill="currentColor" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
                </svg>
                <input placeholder="Quick search" aria-label="Quick search" type="search" name="q">
                <input type="submit" value="Go">
            </form>
        </span>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
            
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label>
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Examples</a><ul>
<li><a class="reference internal" href="#specifying-parameters-by-arguments">Specifying parameters by arguments</a></li>
<li><a class="reference internal" href="#saving-full-trajectory-data">Saving full trajectory data</a></li>
<li><a class="reference internal" href="#using-golfball-with-dakota">Using golfball with Dakota</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="quickstart.html"
                          title="previous chapter">Quickstart</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="developers.html"
                          title="next chapter">For Developers</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/examples.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </nav>
    </div>
</div>
  
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="developers.html" title="For Developers"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="quickstart.html" title="Quickstart"
             accesskey="P">previous</a> |</li>
          <li><img src="_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
              <a href="index.html">golfball 3.0.0 documentation</a> &#187;
              
          </li>
        <li class="nav-item nav-item-this"><a href="">Examples</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="search.html" method="get">
          <input placeholder="Quick search" aria-label="Quick search" type="search" name="q" id="search-box">
          <input type="submit" value="Go">
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="examples">
<span id="id1"></span><h1>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#specifying-parameters-by-arguments" id="id2">Specifying parameters by arguments</a></p></li>
<li><p><a class="reference internal" href="#saving-full-trajectory-data" id="id3">Saving full trajectory data</a></p></li>
<li><p><a class="reference internal" href="#using-golfball-with-dakota" id="id4">Using golfball with Dakota</a></p></li>
</ul>
</nav>
<section id="specifying-parameters-by-arguments">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Specifying parameters by arguments</a><a class="headerlink" href="#specifying-parameters-by-arguments" title="Link to this heading">¶</a></h2>
<p>In addition to the input file, all listed parameters can be specified/overridden
via arguments to the function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">golfball.sim</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sim</span>

<span class="n">gb_sim</span> <span class="o">=</span> <span class="n">Sim</span><span class="p">()</span>
<span class="n">gb_sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gb_sim</span><span class="o">.</span><span class="n">qoi</span><span class="p">)</span>
</pre></div>
</div>
<p>produces:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{&#39;max_height&#39;: 50.08844542014751, &#39;max_range&#39;: 185.2417438617364, &#39;time_of_flight&#39;: 6.28}
</pre></div>
</div>
<p>so Sim.qoi is a dictionary with the Quantities of Interest (QoI), or outputs
from the sim.</p>
<p>Similarly, you can also see what inputs were used by querying the attribute
“inputs”.  Below we do this using the “PrettyPrint” module to make the
dictionary more readable:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pprint</span>
<span class="n">pp</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pp</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">gb_sim</span><span class="o">.</span><span class="n">inputs</span><span class="p">)</span>
</pre></div>
</div>
<p>which produces:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{ &#39;config&#39;: { &#39;out_filename&#39;: &#39;projectile_outputs.yml&#39;,
              &#39;traj_filename&#39;: &#39;projectile_trajectory.h5&#39;,
              &#39;write_traj&#39;: False},
  &#39;params&#39;: { &#39;D&#39;: 0.04222,
              &#39;eD&#39;: 0.0125,
              &#39;g_LL&#39;: [0.0, 0.0, -9.81],
              &#39;m&#39;: 0.0459,
              &#39;rho_scale&#39;: 1.0,
              &#39;wind&#39;: [0.0, 0.0, 0.0]},
  &#39;state&#39;: {&#39;angle&#39;: 38.0, &#39;pos_LL&#39;: [0.0, 0.0, 0.0], &#39;vel_mag&#39;: 70.0},
  &#39;time&#39;: {&#39;dt&#39;: 0.01, &#39;t_init&#39;: 0.0, &#39;t_stop&#39;: 20.0}}
</pre></div>
</div>
<p>All parameters and the initial state (but not the QoIs, those are outputs!)
listed in the output above can specified via an argument list to
<a class="reference internal" href="golfball.html#golfball.sim.main" title="golfball.sim.main"><code class="xref py py-func docutils literal notranslate"><span class="pre">golfball.sim.main()</span></code></a>.  This is usually done to tweak something quickly
or for automated testing purposes.</p>
<p><em>NOTE: Best practice is to edit and use input files so the user has a
re-run-able single source for a run.</em></p>
<p>The sim also runs at the command line:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ gball --verbose --angle 23.0 --vel_mag 75.0
Config Parameters
----------------
-- out_filename   : projectile_outputs.yml
-- traj_filename  : projectile_trajectory.h5
-- write_traj     : False

Time Parameters
----------------
-- dt      : 0.01
-- t_init  : 0.0
-- t_stop  : 20.0

Input Parameters
----------------
-- D          : 0.04222
-- eD         : 0.0125
-- g_LL       : [0.0, 0.0, -9.81]
-- m          : 0.0459
-- rho_scale  : 1.0
-- wind       : [0.0, 0.0, 0.0]

Initial State
----------------
-- angle    : 23.0
-- pos_LL   : [0.0, 0.0, 0.0]
-- vel_mag  : 75.0

Quantities of Interest (QoI):
-----------------------------
-- Distance Travelled:   171.951781 m
-- Max Height:            25.312299 m
-- time @ impact:          4.430000 s
</pre></div>
</div>
<p>or without the verbose output:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ gball --angle 23.0 --vel_mag 75.0
</pre></div>
</div>
</section>
<section id="saving-full-trajectory-data">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Saving full trajectory data</a><a class="headerlink" href="#saving-full-trajectory-data" title="Link to this heading">¶</a></h2>
<p>If the user wants to save the detailed output from the ODE solver of the
trajectory, they can do so by specifying the “write_traj” boolean option.  The
user can also specify a filename for the trajectory using the “–traj_filename”
option.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gb_sim</span><span class="o">.</span><span class="n">write_trajectories</span><span class="p">(</span><span class="s1">&#39;ang24_traj.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>or equivalently at the command line:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ gball --write_traj --traj_filename ang24_traj.h5 --angle 24 --verbose
</pre></div>
</div>
<p>produces the following output:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Config Parameters
----------------
-- out_filename   : projectile_outputs.yml
-- traj_filename  : ang24_traj.h5
-- write_traj     : True

Time Parameters
----------------
-- dt      : 0.01
-- t_init  : 0.0
-- t_stop  : 20.0

Input Parameters
----------------
-- D          : 0.04222
-- eD         : 0.0125
-- g_LL       : [0.0, 0.0, -9.81]
-- m          : 0.0459
-- rho_scale  : 1.0
-- wind       : [0.0, 0.0, 0.0]

Initial State
----------------
-- angle    : 24.0
-- pos_LL   : [0.0, 0.0, 0.0]
-- vel_mag  : 70.0

Quantities of Interest (QoI):
-----------------------------
-- Distance Travelled:   164.399779 m
-- Max Height:            24.850240 m
-- time @ impact:          4.400000 s
</pre></div>
</div>
<p>This saves the output to an HDF5 file for re-loading using the python utility
provided:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">golfball.sim</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_gball_h5</span>

<span class="n">traj_df</span> <span class="o">=</span> <span class="n">load_gball_h5</span><span class="p">(</span><span class="s1">&#39;ang24_traj.h5&#39;</span><span class="p">)</span>

<span class="n">traj_df</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>          p_LL_x  p_LL_y    p_LL_z     v_LL_x  v_LL_y     v_LL_z
time
0.00    0.000000     0.0  0.000000  63.948182     0.0  28.471565
0.01    0.637998     0.0  0.283565  63.651957     0.0  28.241804
0.02    1.273050     0.0  0.564842  63.358889     0.0  28.013898
0.03    1.905186     0.0  0.843849  63.068926     0.0  27.787817
0.04    2.534438     0.0  1.120605  62.782016     0.0  27.563529
...          ...     ...       ...        ...     ...        ...
4.36  163.379549     0.0  0.843387  25.577324     0.0 -19.655098
4.37  163.635142     0.0  0.646483  25.541460     0.0 -19.725570
4.38  163.890378     0.0  0.448876  25.505572     0.0 -19.795884
4.39  164.145254     0.0  0.250566  25.469659     0.0 -19.866042
4.40  164.399771     0.0  0.051556  25.433721     0.0 -19.936041

[441 rows x 6 columns]
</pre></div>
</div>
<p>Which when plotted:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">traj_df</span><span class="p">[[</span><span class="s1">&#39;p_LL_x&#39;</span><span class="p">,</span><span class="s1">&#39;p_LL_y&#39;</span><span class="p">]],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                       <span class="n">traj_df</span><span class="p">[</span><span class="s1">&#39;p_LL_z&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;distance [m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;height [m]&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;trajectory.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>produces:</p>
<img alt="_images/trajectory.png" src="_images/trajectory.png" />
<p>Any other user loading this h5 file should realize that the data is internally
stored to be loaded by the python pandas package into a DataFrame object.  The
HDF5 file has a ‘/traj_df’ group where that data resides.  The formatting of
that group is dictated by how Pandas likes to save its DataFrames in the default
“fixed” format.</p>
</section>
<section id="using-golfball-with-dakota">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Using golfball with Dakota</a><a class="headerlink" href="#using-golfball-with-dakota" title="Link to this heading">¶</a></h2>
<p>This simulation was written to work at the command line with text-editable YAML
input files, which can be used with Dakota via the “fork” interface.  For
example a shell script ‘golfball.sh’ can use the command line tools installed
with this module:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>#!/bin/sh

# Projectile Sim Wrapper for dakota

# See the &quot;Building a black box interface to Simulation Code&quot; (section 10.3) and
# also the &quot;Advanced Simulation Code Interfaces&quot; (chapter 16) in the Dakota
# Users&#39; Manual

# This sript is called as the analysis_driver in dakota.in and is executed per
# sample run by Dakota when it runs an individual job.
#
# It expects two inputs:
#  $1 is specified parameters_file in dakota.in
#  $2 is specified results_file in dakota.in


# --------------
# PRE-PROCESSING
# --------------
# Incorporate the parameters from DAKOTA (parameters.in) into the template
# (projectile_template.yml) to produce the simulation input
# (projectile_inputs.yml)

dprepro $1  projectile_template.yml  projectile_inputs.yml


# --------
# ANALYSIS
# --------
# Run simulation

gball -i projectile_inputs.yml -o projectile_outputs.yml


# ---------------
# POST-PROCESSING
# ---------------
# Process simulation outputs (projectile_outputs.yml) into the format expected
# by Dakota (results.out)

yaml2results projectile_outputs.yml $2
</pre></div>
</div>
<p>to work in conjunction with the following interface block of a dakota.in file:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>interface
    fork
        analysis_drivers = &#39;golfball.sh&#39;
        parameters_file = &#39;dakota_params.in&#39;
        results_file    = &#39;dakota_results.out&#39;
        work_directory directory_tag
        copy_files = &#39;template_files/*&#39;
        named &#39;run/sample&#39; file_save directory_save
</pre></div>
</div>
<p>See the examples in the test/uq_dakota for two examples of how dakota uses this
simulation.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Examples</a><ul>
<li><a class="reference internal" href="#specifying-parameters-by-arguments">Specifying parameters by arguments</a></li>
<li><a class="reference internal" href="#saving-full-trajectory-data">Saving full trajectory data</a></li>
<li><a class="reference internal" href="#using-golfball-with-dakota">Using golfball with Dakota</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="quickstart.html"
                          title="previous chapter">Quickstart</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="developers.html"
                          title="next chapter">For Developers</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/examples.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="developers.html" title="For Developers"
             >next</a> |</li>
        <li class="right" >
          <a href="quickstart.html" title="Quickstart"
             >previous</a> |</li>
          <li><img src="_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
              <a href="index.html">golfball 3.0.0 documentation</a> &#187;
              
          </li>
        <li class="nav-item nav-item-this"><a href="">Examples</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="search.html" method="get">
          <input placeholder="Quick search" aria-label="Quick search" type="search" name="q" id="search-box">
          <input type="submit" value="Go">
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; 
    Copyright
     2020, Erik S. Bailey.
    <br>
    This page is licensed under the Python Software Foundation License Version 2.
    <br>
    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.
    <br>
    
    
    <br>

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br>
    <br>
    
    <br>

    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>

  </body>
</html>